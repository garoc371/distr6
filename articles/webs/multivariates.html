<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multivariate Distributions • distr6</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><!-- docsearch --><script src="../../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Multivariate Distributions">
<meta property="og:description" content="">
<meta property="og:image" content="https://alan-turing-institute.github.io/distr6/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">distr6</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Basic
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/webs/intro_to_r6.html">Introduction to R6</a>
    </li>
    <li>
      <a href="../../articles/webs/constructing_a_distribution.html">Constructing a Distribution</a>
    </li>
    <li>
      <a href="../../articles/webs/parameters.html">Getting and Setting Parameters</a>
    </li>
    <li>
      <a href="../../articles/webs/statistical_methods.html">Statistical Methods</a>
    </li>
    <li>
      <a href="../../articles/webs/properties_traits.html">Properties and Traits</a>
    </li>
    <li>
      <a href="../../articles/webs/multivariates.html">Multivariate Distributions</a>
    </li>
    <li>
      <a href="../../articles/webs/listing.html">Listing</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/webs/s3_piping.html">S3 and Piping</a>
    </li>
    <li>
      <a href="../../articles/webs/decorators.html">Decorators</a>
    </li>
    <li>
      <a href="../../articles/webs/wrappers.html">Wrappers</a>
    </li>
    <li>
      <a href="../../articles/webs/sets.html">Sets and Intervals</a>
    </li>
    <li>
      <a href="../../articles/webs/custom_distributions.html">Custom Distributions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Extension Guidelines
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/webs/preliminaries.html">Preliminaries</a>
    </li>
    <li>
      <a href="../../articles/webs/create_sdistribution.html">Creating an SDistribution</a>
    </li>
    <li>
      <a href="../../articles/webs/create_kernel.html">Creating a Kernel</a>
    </li>
    <li>
      <a href="../../articles/webs/create_decorator.html">Creating a Decorator</a>
    </li>
    <li>
      <a href="../../articles/webs/create_wrapper.html">Creating a Wrapper</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Appendices
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://raphaels1.github.io/pdfs/distr6Cheatsheet.pdf">Cheatsheet</a>
    </li>
    <li>
      <a href="../../articles/webs/api_lifecycle.html">API Lifecycle</a>
    </li>
    <li>
      <a href="../../articles/webs/analytic_and_numeric_methods.html">Analytical and Numerical Methods</a>
    </li>
    <li>
      <a href="../../articles/webs/r_vs_c.html">R vs C</a>
    </li>
    <li>
      <a href="../../articles/webs/r6_and_design_patterns.html">R6 and Design Patterns</a>
    </li>
    <li>
      <a href="../../articles/webs/documentation_in_r6.html">Documentation in R6</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../../reference/">Reference</a>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/RaphaelS1/distr6">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Multivariate Distributions</h1>
            
            <h4 class="date">2019-08-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/alan-turing-institute/distr6/blob/master/vignettes/webs/multivariates.rmd"><code>vignettes/webs/multivariates.rmd</code></a></small>
      <div class="hidden name"><code>multivariates.rmd</code></div>

    </div>

    
    
<p>In the <a href="https://alan-turing-institute.github.io/distr6/articles/webs/properties_traits.html">previous tutorial</a> we used variables and methods to find properties and traits of the Normal distribution. Before that we looked at statistical methods and construction of the Normal distribution. In this tutorial we look at multivariate distributions, which should feel similar to univariate distributions.</p>
<div id="constructing-a-multivariate-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#constructing-a-multivariate-distribution" class="anchor"></a>Constructing a Multivariate Distribution</h2>
<p>Construction of a multivariate distribution is identical to a univariate distribution, except that a vector input is likely to be required for one of the parameters. In keeping with our running Normal example, we will now use the Multivariate Normal distribution.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">MN &lt;-<span class="st"> </span>MultivariateNormal<span class="op">$</span><span class="kw">new</span>(<span class="dt">mean =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">cov =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">MultivariateNormal<span class="op">$</span><span class="kw">new</span>() <span class="co"># This is in fact the default</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; MultiNorm(mean = c(0, 0), cov = c(1, 0, 0, 1))</span></a></code></pre></div>
<p>Notice how this is almost identical to constructing a univariate Normal distribution. We even allow multiple parameterisations</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">MultivariateNormal<span class="op">$</span><span class="kw">new</span>(<span class="dt">mean =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">prec =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; MultiNorm(mean = c(0, 0), prec = c(1, 0, 0, 1))</span></a></code></pre></div>
</div>
<div id="getting-and-setting-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-and-setting-parameters" class="anchor"></a>Getting and Setting Parameters</h2>
<p>Every multivariate distribution includes by default an extra parameter that cannot be updated. This is the <code>K</code> parameter that refers to the ‘number of components or categories’. It ensures that the correct number of inputs are given to the distribution for the d/p/q/r functions and in updating other parameters. It also means that the number of parameters must be identical when updating. Otherwise getting and setting parameters is identical to univariate distributions.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">MN &lt;-<span class="st"> </span>MultivariateNormal<span class="op">$</span><span class="kw">new</span>()</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">MN<span class="op">$</span><span class="kw"><a href="../../reference/getParameterValue.html">getParameterValue</a></span>(<span class="st">"K"</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; [1] 2</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">MN<span class="op">$</span><span class="kw"><a href="../../reference/setParameterValue.html">setParameterValue</a></span>(<span class="dt">mean =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>)) <span class="co"># Causes an error as 1 not 2 means are given</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">MN<span class="op">$</span><span class="kw"><a href="../../reference/setParameterValue.html">setParameterValue</a></span>(<span class="dt">mean =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">MN<span class="op">$</span><span class="kw"><a href="../../reference/setParameterValue.html">setParameterValue</a></span>(<span class="dt">prec =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>)) <span class="co"># Truncated to c(2,0,0,2)</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">MN<span class="op">$</span><span class="kw"><a href="../../reference/parameters.html">parameters</a></span>()</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt;      id           value support                           description</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; 1: mean             0,1       ℝ Vector of means - Location Parameter.</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; 2:  cov 0.5,0.0,0.0,0.5     ℝ^2  Covariance matrix - Scale Parameter.</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; 3: prec         2,0,0,2     ℝ^2   Precision matrix - Scale Parameter.</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; 4:    K               2      ℕ+                  Number of components</span></a></code></pre></div>
</div>
<div id="dpqr" class="section level2">
<h2 class="hasAnchor">
<a href="#dpqr" class="anchor"></a>d/p/q/r</h2>
<p>The biggest difference between univariate and multivariate distributions is in how arguments are passed to the d/p/q/r methods. This differs slightly from R stats. For example to evaluate the pdf of the multinomial distribution at (1,2) in R stats we would run</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/stats/Multinom.html">dmultinom</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">prob =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.2</span>,<span class="fl">0.8</span>))</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; [1] 0.384</span></a></code></pre></div>
<p>Whereas in distr6, each point is its own argument</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">Multinomial<span class="op">$</span><span class="kw">new</span>(<span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">probs =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.2</span>,<span class="fl">0.8</span>))<span class="op">$</span><span class="kw"><a href="../../reference/pdf.html">pdf</a></span>(<span class="dv">1</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; [1] 0.384</span></a></code></pre></div>
<p>There is a very important reason for this: vectorisation. In R stats there is no way to generate multiple points from a multivariate distribution, whereas in distr6…</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">MN<span class="op">$</span><span class="kw"><a href="../../reference/pdf.html">pdf</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; [1] 0.0430785586 0.0001067811</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">MN<span class="op">$</span><span class="kw"><a href="../../reference/rand.html">rand</a></span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt;           V1          V2</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; 1: 0.9694140 -0.39930191</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; 2: 0.2567706  0.44750144</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; 3: 0.2858609 -0.07504136</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; 4: 1.0688075 -0.06693405</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; 5: 1.4272411 -0.04434556</span></a></code></pre></div>
<p>Note: <code><a href="../../reference/cdf.html">cdf()</a></code> and <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code> are often omitted from multivariate distributions n distr6 as no closed form analytic expression exists.</p>
</div>
<div id="summary" class="section level2">
<h2 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h2>
<p>In this tutorial we looked at multivariate distributions and discussed the difference between distr6 and R stats in using the d/p/q/r functions. The <a href="https://alan-turing-institute.github.io/distr6/articles/webs/listing.html">next tutorial</a> concludes the ‘Basic’ set of tutorials with a look at listing in distr6 to help you navigate the package more easily.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#constructing-a-multivariate-distribution">Constructing a Multivariate Distribution</a></li>
      <li><a href="#getting-and-setting-parameters">Getting and Setting Parameters</a></li>
      <li><a href="#dpqr">d/p/q/r</a></li>
      <li><a href="#summary">Summary</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Raphael Sonabend, Franz Kiraly.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'c08037a20302b0f7fe5a1b7060957f04',
    indexName: 'distr6',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
