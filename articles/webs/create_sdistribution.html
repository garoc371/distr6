<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Creating an SDistribution • distr6</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><!-- docsearch --><script src="../../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Creating an SDistribution">
<meta property="og:description" content="">
<meta property="og:image" content="https://alan-turing-institute.github.io/distr6/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">distr6</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Basic
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/webs/intro_to_r6.html">Introduction to R6</a>
    </li>
    <li>
      <a href="../../articles/webs/constructing_a_distribution.html">Constructing a Distribution</a>
    </li>
    <li>
      <a href="../../articles/webs/parameters.html">Getting and Setting Parameters</a>
    </li>
    <li>
      <a href="../../articles/webs/statistical_methods.html">Statistical Methods</a>
    </li>
    <li>
      <a href="../../articles/webs/properties_traits.html">Properties and Traits</a>
    </li>
    <li>
      <a href="../../articles/webs/multivariates.html">Multivariate Distributions</a>
    </li>
    <li>
      <a href="../../articles/webs/listing.html">Listing</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/webs/s3_piping.html">S3 and Piping</a>
    </li>
    <li>
      <a href="../../articles/webs/decorators.html">Decorators</a>
    </li>
    <li>
      <a href="../../articles/webs/wrappers.html">Wrappers</a>
    </li>
    <li>
      <a href="../../articles/webs/sets.html">Sets and Intervals</a>
    </li>
    <li>
      <a href="../../articles/webs/custom_distributions.html">Custom Distributions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Extension Guidelines
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/webs/preliminaries.html">Preliminaries</a>
    </li>
    <li>
      <a href="../../articles/webs/create_sdistribution.html">Creating an SDistribution</a>
    </li>
    <li>
      <a href="../../articles/webs/create_kernel.html">Creating a Kernel</a>
    </li>
    <li>
      <a href="../../articles/webs/create_decorator.html">Creating a Decorator</a>
    </li>
    <li>
      <a href="../../articles/webs/create_wrapper.html">Creating a Wrapper</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Appendices
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://raphaels1.github.io/pdfs/distr6Cheatsheet.pdf">Cheatsheet</a>
    </li>
    <li>
      <a href="../../articles/webs/api_lifecycle.html">API Lifecycle</a>
    </li>
    <li>
      <a href="../../articles/webs/analytic_and_numeric_methods.html">Analytical and Numerical Methods</a>
    </li>
    <li>
      <a href="../../articles/webs/r_vs_c.html">R vs C</a>
    </li>
    <li>
      <a href="../../articles/webs/r6_and_design_patterns.html">R6 and Design Patterns</a>
    </li>
    <li>
      <a href="../../articles/webs/documentation_in_r6.html">Documentation in R6</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../../reference/">Reference</a>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/RaphaelS1/distr6">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Creating an SDistribution</h1>
            
            <h4 class="date">2019-08-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/alan-turing-institute/distr6/blob/master/vignettes/webs/create_sdistribution.rmd"><code>vignettes/webs/create_sdistribution.rmd</code></a></small>
      <div class="hidden name"><code>create_sdistribution.rmd</code></div>

    </div>

    
    
<p>This tutorial assumes that you have a good knowledge of R6 and so we will not be going through the basics of inheritance and private/public methods/variables.</p>
<div id="sdistribution-class" class="section level2">
<h2 class="hasAnchor">
<a href="#sdistribution-class" class="anchor"></a>SDistribution Class</h2>
<p>All implemented probability distributions (excluding Kernels) in distr6 inherit from the <code>SDistribution</code> class. This means they share a common interface. The only differences between these distributions is that some will have methods missing as no analytic results are available. See the <a href="https://raw.githubusercontent.com/wiki/alan-turing-institute/distr6/images/uml.png">uml diagram</a> for an overview of how this all fits in together. A core design principle in distr6 is that only analytic methods are defined in the SDistribution child classes, all numeric results are available through decorators. See the <a href="https://alan-turing-institute.github.io/distr6/articles/webs/decorators.html">decorators</a> tutorial for more information on decorators and the <a href="https://alan-turing-institute.github.io/distr6/articles/webs/analytic_and_numeric_methods.html">analytic and numeric</a> article for further discussions on analytic and numeric methods. The summary is that when creating your own SDistribution class, please do not put any numeric methods in the core interface, if a closed form expression cannot be found, omit the method entirely and it can be imputed with a decorator. If your desired method is not available in one of our decorators but you think it is useful, see the <a href="https://alan-turing-institute.github.io/distr6/articles/webs/create_decorator.html">creating a decorator</a> extension guidelines.</p>
</div>
<div id="creating-an-sdistribution" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-an-sdistribution" class="anchor"></a>Creating an SDistribution</h2>
<div id="sdistribution-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#sdistribution-variables" class="anchor"></a>SDistribution Variables</h3>
<p>Every class inheriting from SDistribution must have the following public variables:</p>
<ul>
<li>name - Full (unique) name of probability distribution</li>
<li>short_name - Short name (unique) id for distribution</li>
<li>description - Short description, usually just the name</li>
<li>package - The package in which the d/p/q/r functions are written</li>
</ul>
<p>For the Normal distribution, the above all looks like</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">Normal &lt;-<span class="st"> </span>R6<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/R6/man/R6Class.html">R6Class</a></span>(<span class="st">"Normal"</span>, <span class="dt">inherit =</span> SDistribution, <span class="dt">lock_objects =</span> F)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">Normal<span class="op">$</span><span class="kw">set</span>(<span class="st">"public"</span>,<span class="st">"name"</span>,<span class="st">"Normal"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">Normal<span class="op">$</span><span class="kw">set</span>(<span class="st">"public"</span>,<span class="st">"short_name"</span>,<span class="st">"Norm"</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">Normal<span class="op">$</span><span class="kw">set</span>(<span class="st">"public"</span>,<span class="st">"description"</span>,<span class="st">"Normal Probability Distribution."</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">Normal<span class="op">$</span><span class="kw">set</span>(<span class="st">"public"</span>,<span class="st">"package"</span>,<span class="st">"stats"</span>)</a></code></pre></div>
<p>Note:</p>
<ol style="list-style-type: decimal">
<li>The <code>lock_objects=F</code> it is very important that this is not left out as it ensures decorators work correctly.</li>
<li>We use the R6 convention of defining the class as succinctly as possible (class name and inherited classes) and then using the <code>set</code> method to add private/public variables/methods</li>
</ol>
</div>
<div id="sdistribution-methods" class="section level3">
<h3 class="hasAnchor">
<a href="#sdistribution-methods" class="anchor"></a>SDistribution Methods</h3>
<p>For the full list of methods to (optimally) include see the ‘Statistical Methods’ section in the help pages of SDistribution: <code><a href="../../reference/SDistribution.html">?SDistribution</a></code>. This <strong>does not</strong> include pdf/cdf/quantile/rand, these are defined in the constructor and not in the class. Once again, if there is no closed form analytic expression possible, omit the method completely.</p>
<p>The following methods are included by default and can therefore by omitted from the class definition:</p>
<ol style="list-style-type: decimal">
<li>prec</li>
<li>correlation</li>
<li>stdev</li>
<li>median</li>
<li>iqr</li>
</ol>
<p>Additionally the <code>pgf</code> method returns NaN if omitted but this can be overloaded by including the method in the class definition. Below is an example of adding four methods to the Normal distribution</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">Normal<span class="op">$</span><span class="kw">set</span>(<span class="st">"public"</span>,<span class="st">"mean"</span>,<span class="cf">function</span>(){</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(self<span class="op">$</span><span class="kw"><a href="../../reference/getParameterValue.html">getParameterValue</a></span>(<span class="st">"mean"</span>))</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">})</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">Normal<span class="op">$</span><span class="kw">set</span>(<span class="st">"public"</span>,<span class="st">"variance"</span>,<span class="cf">function</span>(){</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(self<span class="op">$</span><span class="kw"><a href="../../reference/getParameterValue.html">getParameterValue</a></span>(<span class="st">"var"</span>))</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">})</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">Normal<span class="op">$</span><span class="kw">set</span>(<span class="st">"public"</span>,<span class="st">"skewness"</span>,<span class="cf">function</span>(){</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">})</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">Normal<span class="op">$</span><span class="kw">set</span>(<span class="st">"public"</span>, <span class="st">"mgf"</span>, <span class="cf">function</span>(t){</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>((self<span class="op">$</span><span class="kw"><a href="../../reference/getParameterValue.html">getParameterValue</a></span>(<span class="st">"mean"</span>) <span class="op">*</span><span class="st"> </span>t) <span class="op">+</span><span class="st"> </span>(self<span class="op">$</span><span class="kw"><a href="../../reference/getParameterValue.html">getParameterValue</a></span>(<span class="st">"var"</span>) <span class="op">*</span><span class="st"> </span>t<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span>)))</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">})</a></code></pre></div>
<p>Note:</p>
<ol style="list-style-type: decimal">
<li>Methods that require parameters use the <code>self</code> keyword and the <code>getParameterValue</code> method, we looked at this in the <a href="https://alan-turing-institute.github.io/distr6/articles/webs/custom_distributions.html">custom distribution tutorial</a>
</li>
<li>The arguments to the methods are not optional, they must have the names given in the <code><a href="../../reference/SDistribution.html">?SDistribution</a></code> help page, this ensures that the automated S3 dispatch methods run correctly</li>
</ol>
</div>
<div id="the-constructor" class="section level3">
<h3 class="hasAnchor">
<a href="#the-constructor" class="anchor"></a>The Constructor</h3>
<p>The constructor for all SDistribution objects looks the same, below is the constructor for the Normal distribution, which we will talk through as an example.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">Normal<span class="op">$</span><span class="kw">set</span>(<span class="st">"public"</span>,<span class="st">"initialize"</span>,<span class="cf">function</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">var =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="ot">NULL</span>, <span class="dt">prec =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">                                          <span class="dt">decorators =</span> <span class="ot">NULL</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>){</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  private<span class="op">$</span>.parameters &lt;-<span class="st"> </span><span class="kw">getParameterSet</span>(self, mean, var, sd, prec, verbose)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  self<span class="op">$</span><span class="kw"><a href="../../reference/setParameterValue.html">setParameterValue</a></span>(<span class="dt">mean =</span> mean, <span class="dt">var =</span> var, <span class="dt">sd =</span> sd, <span class="dt">prec =</span> prec)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  pdf &lt;-<span class="st"> </span><span class="cf">function</span>(x1) <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span>(x1, self<span class="op">$</span><span class="kw"><a href="../../reference/getParameterValue.html">getParameterValue</a></span>(<span class="st">"mean"</span>), self<span class="op">$</span><span class="kw"><a href="../../reference/getParameterValue.html">getParameterValue</a></span>(<span class="st">"sd"</span>))</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  cdf &lt;-<span class="st"> </span><span class="cf">function</span>(x1) <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(x1, self<span class="op">$</span><span class="kw"><a href="../../reference/getParameterValue.html">getParameterValue</a></span>(<span class="st">"mean"</span>), self<span class="op">$</span><span class="kw"><a href="../../reference/getParameterValue.html">getParameterValue</a></span>(<span class="st">"sd"</span>))</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  quantile &lt;-<span class="st"> </span><span class="cf">function</span>(p) <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(p, self<span class="op">$</span><span class="kw"><a href="../../reference/getParameterValue.html">getParameterValue</a></span>(<span class="st">"mean"</span>), self<span class="op">$</span><span class="kw"><a href="../../reference/getParameterValue.html">getParameterValue</a></span>(<span class="st">"sd"</span>))</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">  rand &lt;-<span class="st"> </span><span class="cf">function</span>(n) <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(n, self<span class="op">$</span><span class="kw"><a href="../../reference/getParameterValue.html">getParameterValue</a></span>(<span class="st">"mean"</span>), self<span class="op">$</span><span class="kw"><a href="../../reference/getParameterValue.html">getParameterValue</a></span>(<span class="st">"sd"</span>))</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"></a>
<a class="sourceLine" id="cb3-12" data-line-number="12">  super<span class="op">$</span><span class="kw">initialize</span>(<span class="dt">decorators =</span> decorators, <span class="dt">pdf =</span> pdf, <span class="dt">cdf =</span> cdf, <span class="dt">quantile =</span> quantile,</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">                   <span class="dt">rand =</span> rand, <span class="dt">support =</span> Reals<span class="op">$</span><span class="kw">new</span>(<span class="dt">zero =</span> T),</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">                   <span class="dt">symmetric =</span> <span class="ot">TRUE</span>, <span class="dt">type =</span> Reals<span class="op">$</span><span class="kw">new</span>(),</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">                   <span class="dt">valueSupport =</span> <span class="st">"continuous"</span>, <span class="dt">variateForm =</span> <span class="st">"univariate"</span>)</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">  <span class="kw"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(self)</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">})</a></code></pre></div>
<p>Note the following:</p>
<ol style="list-style-type: decimal">
<li>The arguments to the constructor include all possible parameterisations. The default paramterisation is given, whilst the others are NULL. We include the additional arguments ‘decorators’ which determines if the object should be decorated in constructor and ‘verbose’ which lets the user decide if they are informed of the parameterisation in construction.</li>
<li>Every constructor includes the <code>getParameterSet</code> and <code>setParameterValue</code> methods, we will return to these later.</li>
<li>The d/p/q/r methods are defined here in the constructor, either interfacing another package or written by you</li>
<li>The super-class constructor is called, arguments passed to this include the decorators arguments, the d/p/q/r methods, the properties of the distribution including: support (SetInterval); symmetric (logical). And the traits of the distribution including: type (SetInterval); variateForm (“univariate”/“multivariate”/“matrixvariate”); valueSupport (“discrete”/“continuous”/“mixture”).</li>
<li>A distribution is termed symmetric iff it is analytically symmetric, i.e. a CLT style approximation does not count.</li>
<li>If an analytic expression for d/p/q/r is not available, omit this from the constructor and super-class constructor</li>
<li>There are no validation checks for properties or traits. The methods assume that if you are creating your own class that you will only supply valid inputs.</li>
</ol>
</div>
<div id="getparameterset" class="section level3">
<h3 class="hasAnchor">
<a href="#getparameterset" class="anchor"></a>getParameterSet</h3>
<p>In a separate script called getParameterSet.R we have the generic and dispatch methods for every SDistribution. This function validates the initial choice of parameterisation, tells the user the parameterisation (if <code>verbose == TRUE</code>), constructs and returns the ParameterSet for the distribution. Below is the <code>getParameterSet</code> method for the Normal distribution</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">getParameterSet.Normal &lt;-<span class="st"> </span><span class="cf">function</span>(x, mean, var, <span class="dt">sd =</span> <span class="ot">NULL</span>, <span class="dt">prec =</span> <span class="ot">NULL</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>){</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">  var.bool =<span class="st"> </span>sd.bool =<span class="st"> </span>prec.bool =<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">  <span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(prec)){</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">    <span class="cf">if</span>(verbose) <span class="kw"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"Parameterised with mean and prec."</span>)</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">    prec.bool =<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">  } <span class="cf">else</span> <span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(sd)){</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">    <span class="cf">if</span>(verbose) <span class="kw"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"Parameterised with mean and sd."</span>)</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">    sd.bool =<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">  } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">    <span class="cf">if</span>(verbose) <span class="kw"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"Parameterised with mean and var."</span>)</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">    var.bool =<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14">  }</a>
<a class="sourceLine" id="cb4-15" data-line-number="15"></a>
<a class="sourceLine" id="cb4-16" data-line-number="16">  ps &lt;-<span class="st"> </span>ParameterSet<span class="op">$</span><span class="kw">new</span>(<span class="dt">id =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"mean"</span>,<span class="st">"var"</span>,<span class="st">"sd"</span>,<span class="st">"prec"</span>),</a>
<a class="sourceLine" id="cb4-17" data-line-number="17">                         <span class="dt">value =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb4-18" data-line-number="18">                         <span class="dt">support =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(Reals<span class="op">$</span><span class="kw">new</span>(), PosReals<span class="op">$</span><span class="kw">new</span>(), PosReals<span class="op">$</span><span class="kw">new</span>(), PosReals<span class="op">$</span><span class="kw">new</span>()),</a>
<a class="sourceLine" id="cb4-19" data-line-number="19">                         <span class="dt">settable =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="ot">TRUE</span>, var.bool, sd.bool, prec.bool),</a>
<a class="sourceLine" id="cb4-20" data-line-number="20">                         <span class="dt">updateFunc =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="ot">NA</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb4-21" data-line-number="21">                                           <span class="cf">function</span>(self) self<span class="op">$</span><span class="kw"><a href="../../reference/getParameterValue.html">getParameterValue</a></span>(<span class="st">'var'</span>)<span class="op">^</span><span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb4-22" data-line-number="22">                                           <span class="cf">function</span>(self) self<span class="op">$</span><span class="kw"><a href="../../reference/getParameterValue.html">getParameterValue</a></span>(<span class="st">'var'</span>)<span class="op">^-</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb4-23" data-line-number="23">                         <span class="dt">description =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"Mean - Location Parameter"</span>,</a>
<a class="sourceLine" id="cb4-24" data-line-number="24">                                            <span class="st">"Variance - Squared Scale Parameter"</span>,</a>
<a class="sourceLine" id="cb4-25" data-line-number="25">                                            <span class="st">"Standard Deviation - Scale Parameter"</span>,</a>
<a class="sourceLine" id="cb4-26" data-line-number="26">                                            <span class="st">"Precision - Inverse Squared Scale Parameter"</span>))</a>
<a class="sourceLine" id="cb4-27" data-line-number="27">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(ps)</a>
<a class="sourceLine" id="cb4-28" data-line-number="28">}</a></code></pre></div>
<p>Note:</p>
<ol style="list-style-type: decimal">
<li>This is a dispatch method so the method name is <code>getParameterSet.Normal</code>
</li>
<li>Only the non-default parameters are NULL, this helps specify the order of parameter importance (i.e. what happens if the user inputs more than one parameterisation)</li>
<li>The conditionals at the start of the method determine which parameterisation to construct based on given parameters. It additionally sets up a hierarchy, in this case if a user gives all parameterisations then mean and prec are used, if multiple but not prec are given, then sd is used otherwise var.</li>
<li>The default values in the ParameterSet are arbitrary, just make sure they are within the support</li>
<li>The ‘settable’ values are determined by which parameterisation the user constructs. i.e. The parameters called in construction will be <code>TRUE</code> whilst all others are <code>FALSE</code>.</li>
<li>There is a default parameterisation that the <code>updateFunc</code>s reference, this does not need to be the parameterisation chosen by the user. This will also correspond to the <code>.getRefParams</code> method (see below).</li>
</ol>
</div>
<div id="getrefparams" class="section level3">
<h3 class="hasAnchor">
<a href="#getrefparams" class="anchor"></a>.getRefParams</h3>
<p>To ensure that there is no clash of parameterisations or any conflicts between functions that are updated by others, we have an internal method that is called by <code>setParameterValue</code> to ensure the same parameter is always updated. For example in the Normal distribution, it doesn’t matter if the user passes sd, var or prec to <code>setParameterValue</code> internally it is always the variance that is updated, and this is because of the <code>.getRefParams</code> private method. All the other parameterisations are updated automatically using the <code>updateFunc</code>s that you write in the ParameterSet, hence why it is very important that these reference the default parameterisation. This is less abstract by example, again the Normal distribution</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">Normal<span class="op">$</span><span class="kw">set</span>(<span class="st">"private"</span>,<span class="st">".getRefParams"</span>, <span class="cf">function</span>(paramlst){</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  lst =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>()</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">  <span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(paramlst<span class="op">$</span>mean)) lst =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(lst, <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">mean =</span> paramlst<span class="op">$</span>mean))</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">  <span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(paramlst<span class="op">$</span>var)) lst =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(lst, <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">var =</span> paramlst<span class="op">$</span>var))</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">  <span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(paramlst<span class="op">$</span>sd)) lst =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(lst, <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">var =</span> paramlst<span class="op">$</span>sd<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">  <span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(paramlst<span class="op">$</span>prec)) lst =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(lst, <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">var =</span> paramlst<span class="op">$</span>prec<span class="op">^-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(lst)</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">})</a></code></pre></div>
<p>Note</p>
<ol style="list-style-type: decimal">
<li>Again we have set up a hierarchy so that if a user provides multiple parameterisations the preference is given in order of prec -&gt; sd -&gt; var.</li>
<li>The mean is used in every parameterisation hence this is always returned</li>
<li>The variance is the default parameterisation (alongside mean) hence every other option references this</li>
</ol>
<p>Internally this looks a bit like:</p>
<ol style="list-style-type: decimal">
<li>
<code>setParameterValue</code> is called with <code>lst = list(sd = 2)</code>
</li>
<li>
<code>setParameterValue</code> calls <code>.getRefParams(paramlst = list(sd=2))</code>
</li>
<li>
<code>.getRefParams</code> returns <code><a href="https://rdrr.io/r/base/list.html">list(var = 4)</a></code> (sd^2)</li>
<li>
<code><a href="https://rdrr.io/r/base/list.html">list(var = 4)</a></code> is then used by <code>setParameterValue</code> to update the variance</li>
<li>
<code>update</code> is called in the ParameterSet which uses all the <code>updateFunc</code>s to update sd and prec</li>
</ol>
<p>This may seem slightly counter-intuitive as we have first given sd, transformed this to variance then later re-calculated sd. However this is incredibly important as it maintains no clashes when multiple functions are updated and allows complex updates (such as in composite distributions) to run smoothly. Even when only one parameterisation is possible, this is still a required private method as it is called directly in <code>setParmeterValue</code>.</p>
</div>
</div>
<div id="summary" class="section level2">
<h2 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h2>
<p>That’s everything that is required to create your own SDistribution class. In summary the different components include</p>
<ol style="list-style-type: decimal">
<li>The 5 public variables</li>
<li>Public methods: ‘statistical methods’ section in <code><a href="../../reference/SDistribution.html">?SDistribution</a></code>
</li>
<li>The constructor: Includes d/p/q/r methods, properties, traits and an argument for decorators</li>
<li>
<code>getParameterSet</code> dispatch method, written in the <code>getParameterSet.R</code> script</li>
<li>
<code>.getRefParams</code> for ensuring efficient updating of parameters</li>
</ol>
</div>
<div id="extension-guidelines" class="section level2">
<h2 class="hasAnchor">
<a href="#extension-guidelines" class="anchor"></a>Extension Guidelines</h2>
<ul>
<li><a href="https://alan-turing-institute.github.io/distr6/articles/webs/create_kernel.html">Kernel</a></li>
<li><a href="https://alan-turing-institute.github.io/distr6/articles/webs/create_wrapper.html">Wrapper</a></li>
<li><a href="https://alan-turing-institute.github.io/distr6/articles/webs/create_decorator.html">Decorator</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#sdistribution-class">SDistribution Class</a></li>
      <li><a href="#creating-an-sdistribution">Creating an SDistribution</a></li>
      <li><a href="#summary">Summary</a></li>
      <li><a href="#extension-guidelines">Extension Guidelines</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Raphael Sonabend, Franz Kiraly.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'c08037a20302b0f7fe5a1b7060957f04',
    indexName: 'distr6',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
